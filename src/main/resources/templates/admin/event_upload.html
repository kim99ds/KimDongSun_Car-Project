<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<body>

<!--
  403 Motors - 이벤트 통합 등록 화면
  - admin/app.html 레이아웃 안에서 th:replace="~{${contentTemplate} :: content}" 로 렌더링됨
  - 컨트롤러: /admin/event_manage/new
-->

<div th:fragment="content" class="fade-in">

  <!-- 상단 경로/액션 바 (원본 403admin_event_upload.html 느낌 유지) -->
  <div class="navbar bg-card border-b shadow-sm shrink-0 border-[#333] flex-col items-start p-0 z-30 mb-8">
    <div class="w-full p-6 flex justify-between items-center">
      <h2 class="text-xl fw-400 ml-2 text-white">이벤트 통합 관리 &gt; <span class="text-point">이벤트 통합 등록</span></h2>
      <div class="px-4 flex items-center gap-4">
        <a th:href="@{/admin/event_manage(tab='events')}" class="btn-custom btn-ghost-custom text-sm">
          <i class="fa-solid fa-list mr-2"></i>목록으로
        </a>
      </div>
    </div>
  </div>

  <!-- 메시지(있을 때만) -->
  <div th:if="${successMessage != null and !#strings.isEmpty(successMessage)}" class="mb-4 p-3 rounded bg-emerald-900/30 text-emerald-200" th:text="${successMessage}"></div>
  <div th:if="${errorMessage != null and !#strings.isEmpty(errorMessage)}" class="mb-4 p-3 rounded bg-red-900/30 text-red-200" th:text="${errorMessage}"></div>

  <div class="flex-1 overflow-y-auto">
    <form th:action="@{/admin/event_manage}"
          method="post"
          enctype="multipart/form-data"
          th:object="${eventForm}"
          class="max-w-6xl mx-auto pb-20">

      <!-- STEP 1 -->
      <div class="bg-card shadow-lg p-8 mb-8">
        <div class="section-header">
          <span class="step-badge">STEP 1</span>
          <h3 class="text-lg text-white">기본 정보 입력</h3>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
          <div class="form-control">
            <label class="label mb-1"><span class="label-text text-main">이벤트 ID</span></label>
            <input type="text" value="EVT_AUTO_NEW" readonly class="input w-full" />
          </div>

          <div class="form-control">
            <label class="label mb-1"><span class="label-text text-main">기획자</span></label>
            <!-- 실제 저장은 서버에서 로그인 사용자(memberId) 기반으로 처리 -->
            <input type="text" value="관리자" readonly class="input w-full" />
          </div>

          <div class="form-control md:col-span-2">
            <label class="label mb-1"><span class="label-text text-main">이벤트 명</span></label>
            <input type="text" class="input w-full" th:field="*{title}" placeholder="마케팅용 이벤트 제목" />
          </div>

          <div class="form-control">
            <label class="label mb-1"><span class="label-text text-main">시작일</span></label>
            <input type="date" class="input w-full" th:field="*{startDate}" />
          </div>

          <div class="form-control">
            <label class="label mb-1"><span class="label-text text-main">종료일</span></label>
            <input type="date" class="input w-full" th:field="*{endDate}" />
          </div>

          <div class="form-control md:col-span-2">
            <label class="label mb-1"><span class="label-text text-main">상태</span></label>
            <select class="select w-full" th:field="*{status}">
              <option th:each="s : ${statuses}" th:value="${s}" th:text="${s}">ACTIVE</option>
            </select>
          </div>

          <div class="form-control md:col-span-2">
            <label class="label mb-1"><span class="label-text text-main">메인 배너</span></label>
            <input type="file" name="bannerFile" class="file-input w-full" />
            <label class="label"><span class="label-text-alt text-sub">* 권장 사이즈: 1920x600 (JPG, PNG)</span></label>

            <!-- (선택) URL로도 저장하고 싶을 때: bannerImage 사용 -->
            <div class="mt-3">
              <label class="label py-1"><span class="label-text text-xs text-sub">배너 URL(선택)</span></label>
              <input type="text" class="input w-full" th:field="*{bannerImage}" placeholder="/images/banner.jpg 또는 https://..." />
            </div>
          </div>

          <div class="form-control md:col-span-2">
            <label class="label mb-1"><span class="label-text text-main">상세 설명</span></label>
            <textarea class="textarea w-full h-32 bg-[#333] rounded-none border-[#333] text-[#bbb] focus:outline-none focus:border-[#ff6d00]"
                      th:field="*{description}" placeholder="이벤트 상세 내용을 입력하세요."></textarea>
          </div>
        </div>
      </div>

      <!-- STEP 2 -->
      <div class="bg-card shadow-lg p-8 mb-8">
        <div class="section-header">
          <span class="step-badge" style="background-color: var(--color-info); color: white;">STEP 2</span>
          <h3 class="text-lg text-white">타겟(Target) 설정</h3>
        </div>

        <div class="bg-[#1a1a1a] p-5 border border-[#333] mb-6">
          <div class="flex flex-wrap items-end gap-3">
            <div class="form-control w-full md:w-1/4">
              <label class="label py-1"><span class="label-text text-xs text-sub">항목 (Category)</span></label>
              <select class="select w-full" th:field="*{targets[0].targetType}">
                <option th:each="t : ${targetTypes}" th:value="${t}" th:text="${t}">BRAND</option>
              </select>
            </div>
            <div class="form-control w-full md:w-1/3">
              <label class="label py-1"><span class="label-text text-xs text-sub">값 (Value)</span></label>
              <input type="text" class="input w-full" th:field="*{targets[0].targetValue}" placeholder="예: BMW" />
            </div>
            <div class="form-control flex-1">
              <label class="label py-1"><span class="label-text text-xs text-sub">비고</span></label>
              <input type="text" class="input w-full" placeholder="(선택)" />
            </div>
          </div>
        </div>
      </div>

      <!-- STEP 3 -->
      <div class="bg-card shadow-lg p-8 mb-8">
        <div class="section-header">
          <span class="step-badge" style="background-color: var(--color-success); color: white;">STEP 3</span>
          <h3 class="text-lg text-white">혜택/정책(Policy) 설정</h3>
        </div>

        <div class="bg-[#1a1a1a] p-5 border border-[#333] mb-6">
          <div class="flex flex-wrap items-end gap-3">
            <div class="form-control w-full md:w-1/4">
              <label class="label py-1"><span class="label-text text-xs text-sub">할인 타입</span></label>
              <select class="select w-full" th:field="*{policies[0].discountType}">
                <option th:each="d : ${discountTypes}" th:value="${d}" th:text="${d}">PERCENT</option>
              </select>
            </div>
            <div class="form-control w-full md:w-1/3">
              <label class="label py-1"><span class="label-text text-xs text-sub">할인값</span></label>
              <input type="number" step="0.01" class="input w-full text-right" th:field="*{policies[0].discountValue}" placeholder="0" />
            </div>
          </div>
        </div>
      </div>

      <div class="flex justify-end gap-3 pt-4">
        <a th:href="@{/admin/event_manage(tab='events')}" class="btn-custom btn-neutral px-8">취소</a>
        <button type="submit" class="btn-custom btn-brand px-12">
          <i class="fa-solid fa-check mr-2"></i> 이벤트 통합 저장
        </button>
      </div>

    </form>
  </div>

</div>

</body>
</html>
