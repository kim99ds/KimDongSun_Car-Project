<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Member Detail</title>
</head>
<body>

<div th:if="${successMessage}" th:text="${successMessage}"></div>
<div th:if="${errorMessage}" th:text="${errorMessage}"></div>

<h2>회원 상세</h2>

<div>
    <p th:text="'ID: ' + ${member.memberId}"></p>
    <p th:text="'LOGIN_ID: ' + ${member.loginId}"></p>
    <p th:text="'STATUS: ' + ${member.status}"></p>
</div>

<hr/>

<!-- roles는 관리자 상세(/admin/members/{id})에서만 내려오는 값 -->
<div th:if="${roles} != null">
    <p><b>ROLES:</b>
        <span th:each="mr, st : ${roles}">
            <span th:text="${mr.role.roleName}"></span><span th:if="${!st.last}">, </span>
        </span>
    </p>

    <hr/>

    <h3>이름/이메일 변경</h3>
    <form th:action="@{|/admin/members/${member.memberId}/update|}" method="post">
        <div>
            <label>이름</label>
            <input type="text" name="name" th:value="${member.name}"/>
        </div>
        <div>
            <label>이메일</label>
            <input type="email" name="email" th:value="${member.email}"/>
        </div>
        <button type="submit">저장</button>
    </form>

    <hr/>

    <h3>상태 변경</h3>
    <form th:action="@{|/admin/members/${member.memberId}/status|}" method="post" style="display:inline;">
        <button type="submit" name="status" value="ACTIVE">활성화</button>
        <button type="submit" name="status" value="BLOCKED">비활성화</button>
        <button type="submit" name="status" value="DELETED"
                onclick="return confirm('정말 삭제(상태=DELETED) 처리할까요?');">삭제</button>
    </form>

    <hr/>

    <h3>역할</h3>
    <p>회원관리에서는 역할을 <b>조회만</b> 할 수 있습니다.</p>
    <p><a th:href="@{/admin/roles(memberId=${member.memberId})}">역할 변경은 역할관리에서</a></p>

    <hr/>
    <p><a th:href="@{/admin/members}">목록으로</a></p>
</div>

<!-- 일반 유저 상세(/member/detail)에서는 name/email만 보여주기 -->
<div th:if="${roles} == null">
    <h3>내 정보</h3>
    <form th:action="@{/member/update}" method="post">
        <div>
            <label>이름</label>
            <input type="text" name="name" th:value="${member.name}"/>
        </div>
        <div>
            <label>이메일</label>
            <input type="email" name="email" th:value="${member.email}"/>
        </div>
        <button type="submit">저장</button>
    </form>
</div>

</body>
</html>
